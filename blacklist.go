package main

import (
	"regexp"
	"strings"
)

// from https://github.com/c0re100/qBittorrent-Enhanced-Edition/blob/v4_6_x/src/base/bittorrent/peer_blacklist.hpp

var blocklist = []string{
	"-(XL|SD|XF|QD|BN|DL|TS|FG|TT|NX|XP|FD6)(\\d+)-",
	`cacao_torrent`,

	// Offline Downloader filter
	"-LT(1220|2070)-",

	// BitTorrent Media Player Peer
	"StellarPlayer",
	"Elementum",
	"-(UW\\w{4}|SP(([0-2]\\d{3})|(3[0-5]\\d{2})))-",

	// others
	"xunlei",
	"thunder",
	"-.*0001.*-",
	`HP[[:digit:]]{4}`,
	`hp[[:digit:]]{4}`,
	`gt[[:digit:]]{4}`,
	`GT[[:digit:]]{4}`,
	`dt[[:digit:]]{4}`,
	`DT[[:digit:]]{4}`,
	"-TT", "-tt",
	"xl0012",
	"xf",
	"dandanplay",
	"dl3760",
	"qq",
	"libtorrent",
}

var ips = strings.Split(`1.69.138.0/24
1.180.24.0/21
27.153.128.0/24
27.156.139.0/24
27.156.176.0/24
27.159.173.0/24
27.223.182.0/24
27.223.183.0/24
36.5.4.0/24
36.5.10.0/24
36.5.11.0/24
36.102.218.0/24
36.143.132.0/24
36.248.181.0/24
36.250.161.0/24
39.67.55.0/24
39.67.224.0/24
39.67.225.0/24
39.67.227.0/24
39.67.228.0/24
39.67.229.0/24
39.67.230.0/24
39.67.231.0/24
39.67.234.0/24
39.67.235.0/24
39.67.237.0/24
39.67.239.0/24
39.75.210.0/24
39.76.36.0/24
39.76.43.0/24
39.76.51.0/24
39.76.53.0/24
39.76.55.0/24
39.171.34.0/24
39.171.61.0/24
39.172.52.0/24
42.229.177.0/24
42.229.184.0/24
42.242.128.0/19
42.242.248.0/24
59.47.224.0/20
59.58.42.0/24
59.58.117.0/24
59.60.76.0/22
59.60.84.0/22
60.213.104.0/24
60.213.108.0/22
106.58.40.0/21
110.83.135.0/24
110.85.89.0/24
110.85.135.0/24
110.187.212.0/23
111.170.149.0/24
111.175.86.0/24
111.175.87.0/24
112.42.7.0/24
112.45.16.0/24
112.114.32.0/20
112.194.131.0/24
112.228.240.0/21
112.233.105.0/24
112.233.106.0/24
112.233.109.0/24
112.251.203.0/24
114.100.140.0/24
114.100.141.0/24
117.26.235.0/24
117.26.238.0/24
117.64.160.0/22
117.183.53.0/24
119.7.136.0/24 
119.7.166.0/24
119.7.169.0/24
119.7.175.0/24
119.177.130.0/24
119.177.195.0/24
120.33.247.0/24
120.40.132.0/22
120.43.45.0/24
120.43.54.0/24
121.18.90.0/24 
121.205.254.0/24
123.174.79.0/24
123.184.152.0/24
124.114.56.0/24
124.161.217.0/24
153.0.122.0/24
153.0.123.0/24
153.0.125.0/24
182.243.14.0/24
182.243.15.0/24
182.243.16.0/24
182.243.24.0/24
182.243.25.0/24
182.243.36.0/22
182.243.58.0/24
183.160.217.0/24
183.160.218.0/24
183.162.220.0/24
183.208.134.0/23
218.7.138.0/24
218.62.195.0/24
218.104.106.0/24
220.164.208.0/24
220.164.209.0/24
220.164.213.0/24
220.164.214.0/24
220.164.215.0/24
220.164.240.0/21
221.203.3.0/24
221.203.6.0/24
222.134.126.0/24
222.214.187.0/24
222.220.135.0/24
222.220.144.0/22
222.220.149.0/24
222.220.184.0/24
222.220.185.0/24
223.65.186.0/24
2408:8214:1500::/40
2408:8215:154c:8910::/64
2408:8220:1510:50e0::/64
2408:8221:2f10::/48
2408:8256:968f:7a3::/64
2408:8262:8486:4ba3::/64
2408:8270::/32
2408:8352::/32
2408:8360:6451::/48
2408:8361:6451::/48
2408:8361:6451::/48
2409:8a04:1627::/48
2409:8a04:1628::/48
2409:8a20::/32
2409:8a28:7130:1210::/64
2409:8a34:a618:5660::/64
2409:8a3c:ec8:3940::/64
2409:8a5e::/32
240e:314::/32
240e:345::/32
240e:34c::/32
240e:35f:9d8:a000::/64
240e:362::/32
240e:364::/32
240e:385::/32
240e:388::/32
240e:388::/32
240e:398::/32
240e:3b2::/32
240e:3b4::/32
240e:3b7::/32

# from https://github.com/PBH-BTN/BTN-Collected-Rules
123.186.146.156
123.186.146.158
123.186.146.164
123.186.146.177
240e:90e:2000:2005:266e:96ff:fe81:dc2
240e:90e:2000:2005:266e:96ff:fe88:df22
112.10.184.212
112.21.67.40
112.21.67.207
112.42.6.190
120.2.64.130
120.2.65.228
120.2.66.157
120.2.66.186
120.2.67.173
183.208.134.103
183.208.134.141
183.208.134.237
183.208.134.249
183.208.135.6
183.208.135.210
220.205.225.226
223.66.202.48
223.66.202.129
223.66.244.147
223.66.244.177
223.66.250.62
223.66.250.75
223.66.250.99
223.66.250.132
223.66.250.244
223.66.251.16
223.66.251.38
223.66.251.46
223.66.251.108
223.66.251.148
223.66.251.152
223.66.251.174
223.106.152.148
223.106.154.58
223.106.154.97
2408:821a:53a0:ce71:811:ac02:e2f0:aef8
2408:821a:53a0:e371:811:ac02:e2f0:aef8
2408:821a:53a0:f691:4a7:93fb:abff:b892
2408:821a:53a0:f691:1d30:2620:a0ea:e916
2408:821a:53a0:f691:1d4a:2411:3aea:4c0f
2408:821a:53a0:f691:1dbd:bee5:4ad1:6579
2408:821a:53a0:f691:20d6:780c:1106:c273
2408:821a:53a0:f691:cdea:ee12:b96b:1d1c
2408:821a:53a0:f691:f1a6:6f17:f211:bb01
2408:821a:53a0:f691:f48d:c292:f480:b5b3
2408:821b:53a0:171:811:ac02:e2f0:aef8
2408:821b:53a0:1801:fc45:9526:8624:d4b8
2408:8248:4c2a:28a0:ed95:643e:7dfc:c0e8
2408:8249:4c2a:36e0:910a:e086:1798:de84
2408:8444:563:2644:54b2:d851:fdd3:9a3
2408:8445:512:977f:5495:c36f:9190:c778
2408:8445:512:c019:395f:1042:5648:13eb
2408:8445:591:12c:3907:181a:a2b7:4300
2409:873c:f03:6002::200
2409:8a20:6410:51b1:8f0f:f84e:f990:6db5
2409:8a20:6411:82f1:2f2b:38d:529b:da6d
2409:8a20:6412:9ee1:4839:4ffa:8d54:3adf
2409:8a20:6413:cf71:95ca:d52b:e5c1:6b83
2409:8a20:6414:a481:a0d6:26dc:163f:2af6
2409:8a20:641a:e271:a43d:8f75:82c9:f7e7
2409:8a20:641c:3c21:14aa:27a3:c227:1a9f
2409:8a20:641c:4d01:60ed:81f7:17fd:9876
2409:8a20:641d:c521:f554:a462:2a98:34cc
2409:8a20:641e:cda1:fd0b:10e2:d4c7:c4a2
2409:8a20:64b2:9a51:1aa1:de74:3383:9477
2409:8a20:64b2:9ab1:5eb9:1ff:fe88:c383
2409:8a20:64b2:ac11:5eb9:1ff:fe88:c383
2409:8a20:64b2:ad51:494f:9e38:6280:548
2409:8a20:64b4:1531:8f0d:d8a8:2fe0:25bd
2409:8a20:64b4:1571:5eb9:1ff:fe88:c383
2409:8a20:64b4:1f81:224f:8fc3:275b:b89d
2409:8a20:64b4:1ff1:5eb9:1ff:fe88:c383
2409:8a20:64b5:8461:3b5f:6c48:5598:6653
2409:8a20:64b5:84a1:5eb9:1ff:fe88:c383
2409:8a20:64b6:2671::7cb
2409:8a20:64b6:2671:9283:4bdd:82e5:b503
2409:8a20:64b9:1191:4e4e:2136:3ef7:c019
2409:8a20:64b9:3ea1:9a59:2764:9bf1:c980
2409:8a20:64b9:3f81:e19b:87a2:6b2d:43ac
2409:8a20:64b9:c241:5534:91cd:f21d:c169
2409:8a20:64bb:5dc1:6979:527:d80c:962f
2409:8a20:64bb:5f61:add:e324:a771:cc10
2409:8a4c:3e41:28f0:4a2:f4ce:a304:32ae
240e:328:396:1c00::1
240e:3b5:34e0:231:3cca:fe87:1cc3:a641
240e:3b5:34e0:231:51eb:8835:b0e:4c5d
240e:3b5:34e0:231:84cc:23df:e1bd:1e25
240e:3b5:34e0:231:ec05:36a1:157b:dd85
240e:3b5:34e0:231:f9fa:2485:b207:3cb7
240e:3b5:34e0:6871:41e4:8591:9b29:1c93
240e:3b5:34e0:6871:74eb:f6b0:6505:ef74
240e:3b5:34e0:6871:e89b:6451:64dd:5f1d
1.180.24.100
1.180.24.220
1.180.24.222
1.180.24.242
1.180.24.245
1.180.24.48
1.180.24.49
1.180.24.50
1.180.24.51
1.180.24.52
1.180.24.53
1.180.24.54
1.180.24.55
1.180.24.56
1.180.24.57
1.180.24.58
1.180.24.77
1.180.24.78
1.180.24.85
1.180.24.86
1.180.24.87
1.180.24.95
1.180.24.96
1.180.24.97
1.180.25.17
1.180.25.202
1.180.25.203
1.180.25.210
1.180.25.246
1.180.25.247
1.180.25.248
1.180.25.84
1.180.25.94
1.180.25.95
1.180.25.97
112.45.16.196
112.45.16.197
112.45.16.201
112.45.16.202
112.45.16.203
112.45.16.204
112.45.16.205
112.45.16.216
112.45.16.217
112.45.20.227
112.45.20.228
112.45.20.229
112.45.20.233
112.45.20.234
112.45.20.235
112.45.20.236
112.45.20.248
112.45.20.249
112.45.20.250
112.45.20.251
112.45.20.252
119.53.104.244
119.53.105.75
119.53.105.84
119.53.106.133
119.53.107.25
119.53.107.69
119.53.108.160
119.53.108.6
119.53.108.84
119.53.109.104
119.53.109.13
119.53.109.70
119.53.110.149
119.53.110.20
119.53.110.229
119.53.110.80
119.53.111.190
119.53.111.5
119.53.111.74
119.53.112.13
122.224.33.14
122.224.33.15
122.224.33.16
122.224.33.17
123.184.152.100
123.184.152.101
123.184.152.102
123.184.152.103
123.184.152.104
123.184.152.132
123.184.152.133
123.184.152.242
123.184.152.243
123.184.152.244
123.184.152.245
123.184.152.246
123.184.152.247
123.184.152.248
123.184.152.249
123.184.152.39
123.184.152.81
123.184.152.82
123.184.152.83
123.184.152.84
123.184.152.85
123.184.152.86
123.184.152.87
123.184.152.88
123.184.152.89
123.184.152.90
123.184.152.96
123.184.152.97
123.184.152.98
123.184.152.99
123.187.27.190
123.187.27.194
123.187.27.198
123.187.27.202
123.187.27.206
123.187.27.210
123.187.27.214
123.187.27.218
123.187.27.222
123.187.27.226
123.187.27.230
123.187.27.234
123.187.27.238
123.187.27.242
123.187.27.246
123.187.27.250
123.187.27.254
123.187.29.10
123.187.29.14
123.187.29.18
123.187.29.22
123.187.29.26
123.187.29.30
123.187.29.34
123.187.29.38
123.187.29.42
123.187.29.46
123.187.29.6
175.19.0.79
175.19.1.149
175.19.10.103
175.19.10.142
175.19.10.148
175.19.10.222
175.19.10.232
175.19.11.126
175.19.11.132
175.19.11.229
175.19.2.117
175.19.2.179
175.19.2.195
175.19.2.213
175.19.2.215
175.19.2.231
175.19.2.242
175.19.2.243
175.19.2.249
175.19.2.25
175.19.2.27
175.19.2.51
175.19.2.55
175.19.2.92
175.19.2.93
175.19.3.109
175.19.3.128
175.19.3.165
175.19.3.177
175.19.3.2
175.19.3.200
175.19.3.209
175.19.3.241
175.19.3.244
175.19.3.250
175.19.3.39
175.19.3.60
175.19.3.65
175.19.3.78
175.19.3.8
175.19.3.83
175.19.8.106
175.19.8.13
175.19.8.136
175.19.8.137
175.19.8.141
175.19.8.151
175.19.8.173
175.19.8.176
175.19.8.27
175.19.8.47
175.19.8.77
175.19.8.87
175.19.8.9
175.19.9.115
175.19.9.165
175.19.9.178
175.19.9.190
175.19.9.212
175.19.9.71
175.19.9.96
183.131.219.161
183.131.219.162
183.131.219.163
183.131.219.164
183.131.219.165
183.131.219.166
183.131.219.167
183.131.219.168
183.131.219.169
183.131.219.170
211.103.112.139
218.7.138.16
218.7.138.17
218.7.138.18
218.7.138.19
218.7.138.20
218.7.138.21
218.7.138.22
218.7.138.23
218.7.138.24
218.7.138.25
218.7.138.26
218.7.138.27
218.7.138.28
218.7.138.29
221.11.96.66
221.11.96.67
221.11.96.68
221.11.96.71
221.11.96.72
221.11.96.73
221.11.96.74
221.203.3.12
221.203.3.15
221.203.3.16
221.203.3.38
221.203.6.47
221.203.6.48
221.203.6.49
221.203.6.50
221.203.6.51
221.203.6.52
221.203.6.53
221.203.6.54
221.203.6.55
221.203.6.56
221.203.6.57
221.203.6.58
221.203.6.60
221.203.6.61
221.203.6.62
221.9.12.117
221.9.12.118
221.9.12.178
221.9.12.96
221.9.13.92
221.9.14.10
221.9.14.143
221.9.14.226
221.9.15.1
221.9.16.221
221.9.17.220
221.9.18.18
221.9.18.78
221.9.19.120
36.102.218.138
36.102.218.146
36.102.218.147
36.102.218.148
36.102.218.149
36.102.218.150
36.102.218.171
36.102.218.172
36.102.218.173
36.102.218.174
36.102.218.175
36.102.218.176
36.102.218.177
36.102.218.178
36.102.218.179
36.102.218.195
36.102.218.196
36.102.218.197
36.102.218.216
36.102.218.217
36.102.218.222
36.102.218.223
42.248.192.10
42.248.192.11
42.248.192.12
42.248.192.13
42.248.192.14
42.248.192.15
42.248.192.16
42.248.192.17
42.248.192.18
42.248.192.19
42.248.192.20
42.248.192.21
42.248.192.22
42.248.192.23
42.248.192.3
42.248.192.4
42.248.192.5
42.248.192.6
42.248.192.7
42.248.192.8
42.248.192.9
1.196.173.221
1.196.174.73
1.196.175.116
1.196.175.46
120.219.44.133
120.219.44.142
120.219.44.27
120.219.44.71
171.11.144.250
182.32.204.105
182.32.204.177
182.32.204.233
182.32.204.52
182.32.205.142
182.32.205.188
183.227.110.112
183.227.110.118
183.227.110.127
183.227.110.128
183.227.110.130
183.227.110.133
183.227.110.161
183.227.110.173
183.227.110.190
183.227.110.195
183.227.110.2
183.227.110.20
183.227.110.201
183.227.110.21
183.227.110.218
183.227.110.35
183.227.110.48
183.227.110.49
183.227.110.59
183.227.110.8
183.227.110.82
183.227.110.9
183.227.111.11
183.227.111.123
183.227.111.147
183.227.111.150
183.227.111.176
183.227.111.177
183.227.111.180
183.227.111.217
183.227.111.225
183.227.111.229
183.227.111.23
183.227.111.231
183.227.111.25
183.227.111.40
183.227.111.93
183.227.111.94
183.227.111.97
183.228.140.122
183.228.140.149
183.228.140.173
183.228.140.190
183.228.140.243
183.228.140.244
183.228.140.3
183.228.140.46
183.228.140.71
183.228.140.73
183.228.141.1
183.228.141.16
183.228.141.194
183.228.141.195
183.228.141.199
183.228.141.204
183.228.141.208
183.228.141.210
183.228.141.212
183.228.141.22
183.228.141.236
183.228.141.241
183.228.141.252
183.228.141.79
183.228.142.10
183.228.142.100
183.228.142.111
183.228.142.113
183.228.142.116
183.228.142.118
183.228.142.123
183.228.142.124
183.228.142.127
183.228.142.136
183.228.142.14
183.228.142.147
183.228.142.149
183.228.142.150
183.228.142.154
183.228.142.158
183.228.142.167
183.228.142.169
183.228.142.170
183.228.142.181
183.228.142.189
183.228.142.200
183.228.142.216
183.228.142.219
183.228.142.22
183.228.142.225
183.228.142.226
183.228.142.228
183.228.142.237
183.228.142.246
183.228.142.253
183.228.142.32
183.228.142.4
183.228.142.44
183.228.142.49
183.228.142.66
183.228.142.67
183.228.142.73
183.228.142.74
183.228.142.75
183.228.142.76
183.228.142.85
183.228.142.91
183.228.143.105
183.228.143.119
183.228.143.122
183.228.143.125
183.228.143.127
183.228.143.133
183.228.143.134
183.228.143.136
183.228.143.14
183.228.143.165
183.228.143.167
183.228.143.172
183.228.143.177
183.228.143.184
183.228.143.189
183.228.143.190
183.228.143.194
183.228.143.199
183.228.143.202
183.228.143.208
183.228.143.212
183.228.143.216
183.228.143.221
183.228.143.222
183.228.143.224
183.228.143.229
183.228.143.238
183.228.143.248
183.228.143.38
183.228.143.40
183.228.143.43
183.228.143.50
183.228.143.56
183.228.143.69
183.228.143.73
183.228.143.74
183.228.143.98
39.150.2.130
39.150.2.131
39.150.2.132
39.150.2.133
39.150.2.134
39.150.2.135
39.150.2.136
39.150.2.137
39.150.2.138
39.164.253.37
39.164.253.38
39.164.253.39
39.164.253.40
39.164.253.41
39.164.253.42
39.164.253.43
39.164.253.44
39.164.253.45
39.164.253.46
39.164.254.130
39.164.254.131
39.164.254.132
39.164.254.133
39.164.254.134
39.164.254.135
39.164.254.136
39.164.254.137
39.164.254.138
39.164.254.139
39.164.32.102
39.164.32.103
39.164.32.104
39.164.32.110
39.164.32.111
39.164.32.112
39.164.32.115
39.164.32.125
39.164.32.38
39.164.32.45
39.164.32.53
39.164.32.54
39.164.32.57
39.164.32.60
39.164.32.61
39.164.32.70
39.164.32.78
39.164.32.83
39.164.32.89
39.164.33.141
39.164.33.142
39.164.33.143
39.164.33.144
39.164.33.148
39.164.33.149
39.164.33.150
39.164.33.151
39.164.33.152
39.164.33.153
39.164.33.154
39.164.33.173
39.164.33.212
39.164.33.241
39.164.33.242
39.164.33.244
39.164.41.167
39.164.41.187
39.164.41.190
39.164.41.198
39.164.41.203
39.164.41.206
39.164.41.216
39.164.41.220
39.164.41.221
39.164.41.222
39.164.45.10
39.164.45.11
39.164.45.15
39.164.45.18
39.164.45.20
39.164.45.21
39.164.45.22
39.164.45.25
39.164.45.60
39.164.45.61
39.164.45.62
39.164.45.63
39.164.45.64
39.164.45.65
39.164.45.66
39.164.45.67
39.164.45.68
39.164.45.69
39.164.45.70
39.164.45.71
39.164.45.72
39.164.45.74
39.164.45.75
39.164.45.77
39.164.45.78
39.164.45.79
39.164.45.81
39.164.45.82
39.164.45.83
39.164.45.84
39.164.45.85
39.164.45.86
39.164.45.87
39.164.45.88
39.164.45.89
39.164.45.90
39.164.45.91

`, "\n")

var regexps Regexps

func init() {
	for _, v := range blocklist {
		regexps = append(regexps, regexp.MustCompile(v))
	}
}

type Regexps []*regexp.Regexp

func (r Regexps) MatchString(s ...string) bool {
	for _, v := range r {
		for _, v2 := range s {
			if v.MatchString(v2) {
				return true
			}
		}
	}
	return false
}
